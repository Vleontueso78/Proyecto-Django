{% extends "finanzas/base.html" %}
{% load static %}
{% block title %}Detalle del dÃ­a{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/global.css' %}">
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/botones.css' %}">
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/presupuesto.css' %}">
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/fixes.css' %}">
{% endblock %}

{% block content %}
<div id="dashboard-container" class="fade-in">

    <h2 id="titulo-finanzas">
        ğŸ“† {{ fecha|date:"d/m/Y" }}
    </h2>

    <div class="card card-anim">

        {% if not registro.completado %}

            <!-- ESTADO DEL DÃA -->
            <div class="alert alert-warning center mb-6">
                âš  Este dÃ­a estÃ¡ pendiente. CompletÃ¡ los datos para poder cerrarlo.
            </div>

            <form method="post" class="dia-pendiente-form">
                {% csrf_token %}

                <!-- =========================
                     SECCIÃ“N: PRESUPUESTO
                ========================== -->
                <section class="dia-section">
                    <h3 class="dia-section-title">
                        ğŸ’° Presupuesto del dÃ­a
                    </h3>

                    <div class="center" style="margin-top: 10px;">

                        <div id="presupuesto-wrapper" class="editable-field">

                            <div class="presupuesto-display">
                                <span id="presupuesto-signo">$</span>

                                <input
                                    type="number"
                                    name="para_gastar_dia"
                                    class="editable-number"
                                    step="0.01"
                                    value="{{ registro.para_gastar_dia }}"
                                >
                            </div>

                            <button type="button" class="edit-btn">
                                âœ
                            </button>

                        </div>

                    </div>
                </section>

                <!-- =========================
                     SECCIÃ“N: GASTOS
                ========================== -->
                <section class="dia-section">
                    <h3 class="dia-section-title">
                        ğŸ§¾ DistribuciÃ³n de gastos
                    </h3>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>ğŸ½ Alimento</label>
                            <input type="number"
                                   name="alimento"
                                   step="0.01"
                                   value="{{ registro.alimento }}">
                        </div>

                        <div class="form-group">
                            <label>ğŸ›’ Productos</label>
                            <input type="number"
                                   name="productos"
                                   step="0.01"
                                   value="{{ registro.productos }}">
                        </div>

                        <div class="form-group">
                            <label>ğŸ¦ Ahorro / Deuda</label>
                            <input type="number"
                                   name="ahorro_y_deuda"
                                   step="0.01"
                                   value="{{ registro.ahorro_y_deuda }}">
                        </div>
                    </div>
                </section>

                <!-- =========================
                     ACCIONES
                ========================== -->
                <div class="center acciones-dia" style="margin-top: 30px;">
                    <button type="submit" class="btn btn-accent">
                        ğŸ’¾ Guardar dÃ­a
                    </button>

                    <a href="{% url 'finanzas:calendario_ver' %}" class="btn btn-ghost">
                        â¬… Volver al calendario
                    </a>
                </div>
            </form>

        {% else %}

            <!-- =========================
                 DÃA COMPLETADO
            ========================== -->

            <form method="post">
                {% csrf_token %}

                <div class="resumen-grid editable-group" style="margin-bottom: 20px;">

                    <div class="editable-field">
                        <div class="muted">ğŸ’° Presupuesto</div>
                        <input type="number" name="para_gastar_dia"
                               class="editable-number"
                               step="0.01"
                               value="{{ registro.para_gastar_dia }}"
                               readonly>
                        <button type="button" class="edit-btn">âœ</button>
                    </div>

                    <div class="editable-field">
                        <div class="muted">ğŸ½ Alimento</div>
                        <input type="number" name="alimento"
                               class="editable-number"
                               step="0.01"
                               value="{{ registro.alimento }}"
                               readonly>
                        <button type="button" class="edit-btn">âœ</button>
                    </div>

                    <div class="editable-field">
                        <div class="muted">ğŸ›’ Productos</div>
                        <input type="number" name="productos"
                               class="editable-number"
                               step="0.01"
                               value="{{ registro.productos }}"
                               readonly>
                        <button type="button" class="edit-btn">âœ</button>
                    </div>

                    <div class="editable-field">
                        <div class="muted">ğŸ¦ Ahorro / Deuda</div>
                        <input type="number" name="ahorro_y_deuda"
                               class="editable-number"
                               step="0.01"
                               value="{{ registro.ahorro_y_deuda }}"
                               readonly>
                        <button type="button" class="edit-btn">âœ</button>
                    </div>

                </div>

                <hr>

                <div class="resumen-grid" style="margin-top: 20px;">
                    <div>
                        <div class="muted">ğŸ’¸ Gasto total</div>
                        <div class="resumen-valor">${{ registro.gasto_total }}</div>
                    </div>

                    <div>
                        <div class="muted">ğŸ“Š Balance diario</div>
                        <div class="resumen-valor">${{ registro.balance_diario }}</div>
                    </div>

                    <div>
                        <div class="muted">ğŸ’µ Sobrante efectivo</div>
                        <div class="resumen-valor">${{ registro.sobrante_efectivo }}</div>
                    </div>
                </div>

                <div class="center" style="margin-top: 30px;">
                    <button type="submit" class="btn btn-accent">
                        ğŸ’¾ Guardar cambios
                    </button>

                    <a href="{% url 'finanzas:calendario_ver' %}" class="btn btn-ghost">
                        â¬… Volver al calendario
                    </a>
                </div>

            </form>

        {% endif %}

    </div>
</div>
{% endblock %}