{% extends "finanzas/base.html" %}
{% load static %}

{% block title %}Completar dÃ­a pendiente{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/global.css' %}">
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/botones.css' %}">
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/pendientes.css' %}">
<link rel="stylesheet" href="{% static 'css/finanzas/finanzas_dashboard/registro_diario.css' %}">
{% endblock %}

{% block content %}
<div class="card card-anim fade-in" style="max-width: 600px; margin: auto;">

    <h2 class="center mb-4">
        ğŸ“ Completar registro<br>
        <span class="muted">DÃ­a {{ fecha|date:"d/m/Y" }}</span>
    </h2>

    <form method="POST" novalidate>
        {% csrf_token %}

        <!-- ======================
             PRESUPUESTO
        ======================= -->
        <div class="editable-field">
            <label>ğŸ’° Para gastar del dÃ­a</label>

            <input id="para-gastar-input"
                   type="number"
                   step="0.01"
                   name="para_gastar_dia"
                   class="editable-number"
                   value="{{ form_values.para_gastar_dia|default_if_none:'0' }}"
                   readonly>

            <div class="field-actions">
                <button type="button"
                        class="edit-btn"
                        data-target="para-gastar-input">
                    âœ
                </button>
            </div>
        </div>

        <!-- ======================
             GASTOS
        ======================= -->

        <!-- ALIMENTO -->
        <div class="editable-field">
            <label>ğŸ½ Alimento</label>

            <input id="alimento-input"
                   type="number"
                   step="0.01"
                   name="alimento"
                   class="editable-number {% if fixed_fields.alimento %}input-locked{% endif %}"
                   value="{{ form_values.alimento|default_if_none:'0' }}"
                   {% if fixed_fields.alimento %}readonly{% endif %}>

            <div class="field-actions">
                <button type="button"
                        class="edit-btn"
                        data-target="alimento-input"
                        {% if fixed_fields.alimento %}disabled{% endif %}>
                    âœ
                </button>

                <button type="button"
                        class="lock-btn"
                        data-target="alimento-input">
                    {% if fixed_fields.alimento %}ğŸ”’{% else %}ğŸ”“{% endif %}
                </button>
            </div>
        </div>

        <!-- PRODUCTOS -->
        <div class="editable-field">
            <label>ğŸ›’ Productos</label>

            <input id="productos-input"
                   type="number"
                   step="0.01"
                   name="productos"
                   class="editable-number {% if fixed_fields.productos %}input-locked{% endif %}"
                   value="{{ form_values.productos|default_if_none:'0' }}"
                   {% if fixed_fields.productos %}readonly{% endif %}>

            <div class="field-actions">
                <button type="button"
                        class="edit-btn"
                        data-target="productos-input"
                        {% if fixed_fields.productos %}disabled{% endif %}>
                    âœ
                </button>

                <button type="button"
                        class="lock-btn"
                        data-target="productos-input">
                    {% if fixed_fields.productos %}ğŸ”’{% else %}ğŸ”“{% endif %}
                </button>
            </div>
        </div>

        <!-- AHORRO / DEUDA -->
        <div class="editable-field">
            <label>ğŸ¦ Ahorro / Deuda</label>

            <input id="ahorro-input"
                   type="number"
                   step="0.01"
                   name="ahorro_y_deuda"
                   class="editable-number {% if fixed_fields.ahorro_y_deuda %}input-locked{% endif %}"
                   value="{{ form_values.ahorro_y_deuda|default_if_none:'0' }}"
                   {% if fixed_fields.ahorro_y_deuda %}readonly{% endif %}>

            <div class="field-actions">
                <button type="button"
                        class="edit-btn"
                        data-target="ahorro-input"
                        {% if fixed_fields.ahorro_y_deuda %}disabled{% endif %}>
                    âœ
                </button>

                <button type="button"
                        class="lock-btn"
                        data-target="ahorro-input">
                    {% if fixed_fields.ahorro_y_deuda %}ğŸ”’{% else %}ğŸ”“{% endif %}
                </button>
            </div>
        </div>

        <!-- ======================
             SOBRANTE
        ======================= -->
        <div class="editable-field">
            <label>ğŸ’µ Sobrante (cÃ¡lculo automÃ¡tico)</label>

            <input type="number"
                   readonly
                   class="editable-number input-locked"
                   value="{{ registro.sobrante_monetario|default_if_none:'0' }}">
        </div>

        <button type="submit" class="btn btn-primary w-full mt-5">
            ğŸ’¾ Guardar registro
        </button>
    </form>

    <div class="center mt-4">
        <a class="btn btn-ghost" href="{% url 'finanzas:registros_pendientes' %}">
            â† Volver a pendientes
        </a>
    </div>

</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/finanzas/sobrante.js' %}"></script>
<script src="{% static 'js/finanzas/dashboard.js' %}"></script>
<script src="{% static 'js/finanzas/completar_pendiente.js' %}"></script>
{% endblock %}